# Copyright (C) 2021 Huawei Device Co., Ltd.
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

#import("//build/test.gni")
import("//test/xts/tools/build/suite.gni")

#module_output_path = "hits/huks_standard"
########################################################
config("module_private_config") {
  visibility = [ ":*" ]
  include_dirs = [
    "//utils/native/base/include",
    "//third_party/bounds_checking_function/include",
    "//third_party/musl/porting/linux/user/include",

    #"unittest/include",
    #"include",
    "//test/xts/acts/security_lite/huks/common/include",

    #"../../../../../../third_party/musl/libc-test/src/common",
  ]
}

########################################################
ohos_moduletest_suite("ActToolChainRegressionTest") {
  configs = [ ":module_private_config" ]
  cflags_cc = [ "-DHILOG_ENABLE" ]
  defines = [ "_STANDARD_SYSTEM_" ]

  sources = [
    "dn_expand-empty.cpp",
    "dn_expand-ptr-0.cpp",
    "fgets-eof.cpp",
    "fgetwc-buffering.cpp",
    "fpclassify-invalid-ld80.cpp",
    "ftello-unflushed-append.cpp",
    "getpwnam_r-crash.cpp",
    "getpwnam_r-errno.cpp",
    "iconv-roundtrips.cpp",
    "inet_ntop-v4mapped.cpp",
    "inet_pton-empty-last-field.cpp",
    "iswspace-null.cpp",
    "lrand48-signextend.cpp",
    "malloc-0.cpp",

    #"malloc-brk-fail.cpp",
    "mbsrtowcs-overflow.cpp",
    "memmem-oob-read.cpp",
    "memmem-oob.cpp",
    "mkdtemp-failure.cpp",
    "mkstemp-failure.cpp",
    "printf-1e9-oob.cpp",
    "printf-fmt-g-round.cpp",
    "printf-fmt-g-zeros.cpp",
    "printf-fmt-n.cpp",
    "pthread-robust-detach.cpp",
    "pthread_cond-smasher.cpp",
    "pthread_cond_wait-cancel_ignored.cpp",
    "pthread_condattr_setclock.cpp",
    "pthread_exit-cancel.cpp",
    "pthread_rwlock-ebusy.cpp",
    "putenv-doublefree.cpp",
    "regex-backref-0.cpp",
    "regex-bracket-icase.cpp",
    "regex-ere-backref.cpp",
    "regex-escaped-high-byte.cpp",
    "regex-negated-range.cpp",
    "rlimit-open-files.cpp",
    "scanf-bytes-consumed.cpp",
    "scanf-match-literal-eof.cpp",
    "scanf-nullbyte-char.cpp",
    "setvbuf-unget.cpp",
    "sigaltstack.cpp",
    "sigprocmask-internal.cpp",
    "sigreturn.cpp",
    "sscanf-eof.cpp",
    "statvfs.cpp",
    "strverscmp.cpp",
    "uselocale-0.cpp",
    "wcsncpy-read-overflow.cpp",
    "wcsstr-false-negative.cpp",
  ]

  include_dirs = [
    "//utils/native/base/include",
    "//third_party/bounds_checking_function/include",
    "//test/xts/acts/toolchain/libc-test/commom",
    "//third_party/musl/porting/linux/user/include",
    "//third_party/musl/porting/linux/user/src/sched",

    #"//third_party/musl/include",
  ]

  deps = [
    "//third_party/bounds_checking_function:libsec_static",
    "//utils/native/base:utils",
  ]

  ldflags = [
    "-ldl",
    "-nostdlib",
  ]

  libs = [
    "${root_out_dir}/obj/test/xts/acts/toolchain/libc-test/commom/libcommom.a",
  ]
}
